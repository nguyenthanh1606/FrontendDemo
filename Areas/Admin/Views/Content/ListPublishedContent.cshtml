
@model PagedList.IPagedList<Admin.Models.PublishedContentViewModel>
@using PagedList.Mvc;

@Styles.Render("~/Content/pagedList")

@using (Ajax.BeginForm("UpdateRank", "Content", new AjaxOptions { InsertionMode = InsertionMode.Replace, UpdateTargetId = "list", HttpMethod = "Post" }, new { @id = "mainform" }))
{
    @Html.AntiForgeryToken()
    @Html.Hidden("CategoryID", (int?)ViewBag.CategorySelected)
    <table class="table table-hover">
        <thead class="thead-inverse">
            <tr>
                <th class="width-9">
                    @Html.DisplayName(@Resource.Headline)
                </th>
                <th class="width-6">
                    @Html.DisplayName(@Resource.Groups)
                </th>
                <th class="width-2">
                    @Html.DisplayName(@Resource.Priority)
                </th>
                <th class="width-3">
                    @Html.DisplayName(@Resource.Action)
                </th>
            </tr>
        </thead>
        <tbody>
            @for (int i = 0; i < @Model.Count(); i++)
            {
                <tr>
                        @Html.HiddenFor(model => model[i].Version)
                    <td>
                        @Html.DisplayTextFor(model => model[i].Headline) @Html.HiddenFor(model => model[i].ContentID)
                    </td>
                    <td>
                        @Html.DisplayTextFor(model => model[i].Group) @Html.HiddenFor(model => model[i].GroupID)
                    </td>
                    <td>
                        @Html.DropDownListFor(model => model[i].RankID, new SelectList(@ViewBag.ResultAllRank, "RankID", "Rank", @Model[i].RankID), new { @class = "input" })
                    </td>
                    <td>
                        <div class="btn-group">
                            <a href="@Url.Action("Edit", new { id = @Model[i].ContentID })" class="btn btn-default">
                                <i class="fa fa-pencil" aria-hidden="true"></i> @Resource.Edit
                            </a>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
                                <span class="caret"></span>
                                <span class="sr-only">Toggle Dropdown</span>
                            </button>

                            <ul class="dropdown-menu btn-dropdown-menu" role="menu">
                                <li>
                                    <a href="@Url.Action("Details", new { id = @Model[i].ContentID })">
                                        <i class="fa fa-eye" aria-hidden="true"></i> @Resource.View
                                    </a>
                                </li>
                                <li>
                                    <a href="@Url.Action("RePublish", new { id = @Model[i].ContentID })">
                                        <i class="fa fa-share-square-o" aria-hidden="true"></i> @Resource.RePublish
                                    </a>
                                </li>
                                <li>
                                    <a href="#" onclick="PauseContent(@Model[i].ContentID, '@Model[i].Headline')">
                                        <i class="fa fa-pause" aria-hidden="true"></i> @Resource.Pause
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </td>
                </tr>
            }
        </tbody>
    </table>
}

<div class="pull-left">
    @string.Format(Resource.PaginationTxt, Model.PageCount < Model.PageNumber ? 0 : Model.PageNumber, @Model.PageCount)
</div>
<div class="pull-right">
    @Html.PagedListPager(Model, page => Url.Action("ListPublishedContent",
        new { page, CategoryID = @ViewBag.CategorySelected, SearchString = @ViewBag.SearchString }),
        PagedListRenderOptions.EnableUnobtrusiveAjaxReplacing(new AjaxOptions() {
            HttpMethod = "GET", UpdateTargetId = "list", OnSuccess = string.Format("UpdatePagingAjaxUrl(this)") }))
</div>

<div id="pauseModal" class="modal fade" role="dialog">
    <div class="modal-dialog">
        @using (Ajax.BeginForm("Pause", null,new AjaxOptions
        {
            HttpMethod = "POST",
            UpdateTargetId = "list",
            InsertionMode = InsertionMode.Replace,
            OnFailure = string.Format("ShowAlertDialog({0})", Resource.UnknowErrorMessage)
        }, new { id = "pause_form" }))
        {
            @Html.AntiForgeryToken()
            @Html.Hidden("CategoryID", (int?)ViewBag.CategorySelected)
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">&times;</button>
                    <h4 class="modal-title" id="pause_title"></h4>
                    <input type="hidden" name="id" id="pause_id" />
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="reject_reason">@Resource.RejectedReasons</label>
                        <textarea type="text" class="form-control" id="pause_reason" name="reason"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" onclick="SubmitPause()">@Resource.Pause</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">@Resource.Close</button>
                </div>
            </div>
        }
    </div>
</div>